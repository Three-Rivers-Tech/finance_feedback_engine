# ============================================================
# Finance Feedback Engine 2.0 - PRODUCTION Environment
# ============================================================
# Copy this file to .env.production and fill in actual values
# See .env.example for full list of configuration options
# ============================================================

# ============================================================
# ENVIRONMENT
# ============================================================
ENVIRONMENT="production"

# ============================================================
# POSTGRESQL DATABASE CONFIGURATION
# ============================================================
# Use strong passwords in production!
DATABASE_URL="postgresql+psycopg2://ffe_user:your_strong_password@postgres:5432/ffe"
POSTGRES_USER="ffe_user"
POSTGRES_PASSWORD="your_strong_password"
POSTGRES_DB="ffe"

# Production pool settings (higher for multi-worker deployment)
DB_POOL_SIZE="30"
DB_POOL_OVERFLOW="15"
DB_POOL_RECYCLE="3600"
DB_POOL_TIMEOUT="30"

# ============================================================
# CORS CONFIGURATION (Required for Frontend)
# ============================================================
# Allow frontend to access backend API from these origins
# Add your production domain here when deploying
ALLOWED_ORIGINS="http://localhost,http://localhost:80,http://127.0.0.1"

# ============================================================
# ALPHA VANTAGE API
# ============================================================
ALPHA_VANTAGE_API_KEY="your_production_alphavantage_key"

# ============================================================
# TRADING PLATFORM - PRODUCTION
# ============================================================
TRADING_PLATFORM="coinbase_advanced"  # or "oanda" for forex

# ============================================================
# COINBASE CREDENTIALS - PRODUCTION
# ============================================================
COINBASE_API_KEY="your_production_coinbase_key"
COINBASE_API_SECRET="your_production_coinbase_secret"
COINBASE_USE_SANDBOX="false"  # CRITICAL: Must be false for production

# ============================================================
# OANDA CREDENTIALS - PRODUCTION
# ============================================================
OANDA_API_KEY="your_production_oanda_token"
OANDA_ACCOUNT_ID="your_production_oanda_account"
OANDA_ENVIRONMENT="live"  # CRITICAL: Must be 'live' for production

# ============================================================
# DECISION ENGINE - PRODUCTION
# ============================================================
DECISION_ENGINE_AI_PROVIDER="local"  # or "ensemble" for multi-model
DECISION_ENGINE_MODEL_NAME="llama3.2:3b-instruct-q4_0"
DECISION_ENGINE_DECISION_THRESHOLD="0.80"  # Higher threshold for production

# ============================================================
# ENSEMBLE CONFIGURATION (if using ensemble)
# ============================================================
ENSEMBLE_VOTING_STRATEGY="weighted"
ENSEMBLE_ADAPTIVE_LEARNING="true"
ENSEMBLE_LEARNING_RATE="0.05"  # Conservative learning rate

# ============================================================
# TWO-PHASE ENSEMBLE
# ============================================================
TWO_PHASE_ENABLED="true"
TWO_PHASE_PHASE1_CONFIDENCE_THRESHOLD="0.80"
TWO_PHASE_HIGH_STAKES_POSITION_THRESHOLD="1000"

# ============================================================
# MONITORING - PRODUCTION (ENABLED)
# ============================================================
MONITORING_ENABLED="true"
MONITORING_PULSE_INTERVAL_SECONDS="60"
MONITORING_MANUAL_CLI="false"

# ============================================================
# ERROR TRACKING - PRODUCTION (REQUIRED)
# ============================================================
ERROR_TRACKING_ENABLED="true"
ERROR_TRACKING_BACKEND="sentry"
SENTRY_DSN="https://your_sentry_dsn@sentry.io/project"
SENTRY_TRACES_SAMPLE_RATE="0.1"  # 10% trace sampling
SENTRY_ENVIRONMENT="production"

# ============================================================
# LOGGING - PRODUCTION
# ============================================================
LOGGING_LEVEL="INFO"  # INFO for production (not DEBUG)
LOGGING_STRUCTURED_ENABLED="true"
LOGGING_STRUCTURED_FORMAT="json"
LOGGING_CONSOLE_ENABLED="false"  # Disable console in production
LOGGING_FILE_ENABLED="true"

# ============================================================
# PORTFOLIO MEMORY - PRODUCTION
# ============================================================
PORTFOLIO_MEMORY_ENABLED="true"
PORTFOLIO_MEMORY_LEARNING_RATE="0.05"
PORTFOLIO_MEMORY_THOMPSON_SAMPLING="true"

# ============================================================
# AGENT MODE - PRODUCTION (CAREFUL WITH AUTO-TRADING)
# ============================================================
AGENT_AUTONOMOUS_ENABLED="false"  # Require manual approval
AGENT_APPROVAL_POLICY="manual"
AGENT_AUTO_RESTART_ON_ERROR="true"

# ============================================================
# RISK MANAGEMENT - PRODUCTION
# ============================================================
SAFETY_MAX_LEVERAGE="1.0"
SAFETY_MAX_POSITION_PCT="0.10"  # Max 10% per position
SAFETY_CIRCUIT_BREAKER_ENABLED="true"
SAFETY_MAX_DAILY_LOSS="0.05"  # Max 5% daily loss

# ============================================================
# API AUTHENTICATION (for FastAPI service)
# ============================================================
API_AUTH_ENABLED="true"
API_AUTH_RATE_LIMIT_MAX="100"
API_AUTH_RATE_LIMIT_WINDOW="60"
# Generate strong key: openssl rand -hex 32
FINANCE_FEEDBACK_API_KEY="your_secure_api_key_here"

# ============================================================
# JWT CONFIGURATION (for API tokens)
# ============================================================
# CRITICAL: Generate secure key for production:
#   python3 -c "import secrets; print(secrets.token_urlsafe(64))"
# NEVER use default values or commit secrets to version control!
JWT_SECRET_KEY="your_jwt_secret_key_change_in_production"
JWT_ALGORITHM="HS256"
JWT_ACCESS_TOKEN_EXPIRE_MINUTES="30"
# Recommended: Set issuer and audience for production
JWT_ISSUER="finance-feedback-engine-prod"
JWT_AUDIENCE="api-users"

# ============================================================
# TELEGRAM NOTIFICATIONS - PRODUCTION
# ============================================================
TELEGRAM_ENABLED="true"
TELEGRAM_BOT_TOKEN="your_telegram_bot_token"
TELEGRAM_CHAT_ID="your_telegram_chat_id"

# ============================================================
# OBSERVABILITY - PRODUCTION
# ============================================================
TRACING_ENABLED="true"
OBSERVABILITY_ENABLED="true"
OBSERVABILITY_BACKEND="jaeger"
OBSERVABILITY_EXPORT_PROMETHEUS="true"
OBSERVABILITY_METRICS_PORT="8000"

# ============================================================
# REDIS (Optional - for distributed caching)
# ============================================================
REDIS_ENABLED="false"  # Enable if using Redis service
REDIS_HOST="redis"
REDIS_PORT="6379"
REDIS_DB="0"

# ============================================================
# DOCKER/DEPLOYMENT PORTS
# ============================================================
BACKEND_PORT="8000"
FRONTEND_PORT="80"
FRONTEND_HTTPS_PORT="443"
PROMETHEUS_PORT="9090"
GRAFANA_PORT="3001"

# ============================================================
# GRAFANA CREDENTIALS
# ============================================================
GRAFANA_ADMIN_USER="admin"
GRAFANA_ADMIN_PASSWORD="change_me_in_production_use_strong_password"

# ============================================================
# SIGNAL MODE (Dry-run / Paper Trading)
# ============================================================
SIGNAL_ONLY_DEFAULT="false"  # Set to true for paper trading
PAPER_TRADING_MODE="false"

# ============================================================
# PERSISTENCE
# ============================================================
PERSISTENCE_ENABLED="true"
PERSISTENCE_STORAGE_PATH="/app/data/decisions"
PERSISTENCE_MAX_DECISIONS="10000"

# ============================================================
# NOTES FOR PRODUCTION DEPLOYMENT
# ============================================================
# 1. Change all passwords and API keys above
# 2. Enable HTTPS with SSL certificates
# 3. Set up proper firewall rules
# 4. Configure your backup schedule (see your infra tooling)
# 5. Enable monitoring and alerting
# 6. Set AGENT_AUTONOMOUS_ENABLED=false until thoroughly tested
# 7. Start with SIGNAL_ONLY_DEFAULT=true for paper trading
# ============================================================
